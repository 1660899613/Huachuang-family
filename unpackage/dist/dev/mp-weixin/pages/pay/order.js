(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/order"],{434:function(e,t,n){"use strict";(function(e){n(5);o(n(3));var t=o(n(435));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},435:function(e,t,n){"use strict";n.r(t);var o=n(436),r=n(438);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n(440);var a,d=n(11),c=Object(d["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);c.options.__file="pages/pay/order.vue",t["default"]=c.exports},436:function(e,t,n){"use strict";n.r(t);var o=n(437);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},437:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return r})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return i})),n.d(t,"components",(function(){return o}));try{o={uImage:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-image/u-image")]).then(n.bind(null,684))},uNumberBox:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-number-box/u-number-box")]).then(n.bind(null,878))}}}catch(d){if(-1===d.message.indexOf("Cannot find module")||-1===d.message.indexOf(".vue"))throw d;console.error(d.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement;e._self._c},i=!1,a=[];r._withStripped=!0},438:function(e,t,n){"use strict";n.r(t);var o=n(439),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},439:function(e,t,n){"use strict";(function(e){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){var e;return e={value:1,id:null,infor:{},customer_id:""},n(e,"infor",{}),n(e,"userInfo",{}),n(e,"fddInfo",{}),n(e,"orderInfo",{}),e},onLoad:function(e){this.id=e.id,this.getDetails()},onShow:function(){this.getUserInfo()},methods:{getUserInfo:function(){var t=this;e.showLoading({title:"加载中",mask:!0}),this.$u.api.getUserInfo({}).then((function(n){t.userInfo=n.data.userInfo,t.fddInfo=n.data.fddInfo,e.hideLoading(),console.log("this.fddInfo.url:",t.fddInfo.url)}))},getDetails:function(){var e=this;this.$u.api.getCourseInfo({id:this.id}).then((function(t){console.log(t,"data"),e.infor=t.data.course}))},valChange:function(e){console.log("当前值为: "+e.value)},orderCreate:function(){var t=this;e.showLoading({title:"加载中"}),this.$u.api.orderCreate({courseId:this.id,count:this.value}).then((function(e){t.orderInfo=e.data.orderId,console.log(e,"data"),t.upcontract()}))},registerFdd:function(){var t=this,n=this;this.$u.api.signCode({open_id:this.userInfo.userPhone,account_type:this.$c.account_type}).then((function(o){var r={app_id:t.$c.app_id,timestamp:o.data.timestamp,v:t.$c.v,msg_digest:o.data.signCode,open_id:t.userInfo.userPhone,account_type:t.$c.account_type};e.request({url:n.$c.fddApiUrl+"account_register.api",header:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},data:r,method:"POST",success:function(t){var o=t.data;console.log(o,"updata...."),n.customer_id=o.data,e.setStorageSync("customer_id",n.customer_id),n.getFddUrl()},fail:function(e){console.log(e)}})}))},fddSave:function(e,t,n,o){this.$u.api.fddSave({customerId:e,transactionId:t,url:n}).then((function(e){console.log(e,"data fddSave"),o()}))},getFddUrl:function(){var t=this,n=1,o=2,r="http://huachuang.yxy5g.com//home/fddNotify",i="",a=1,d=1,c=this;this.$u.api.signCode({customer_id:this.customer_id,verified_way:n,page_modify:o,cert_flag:d,notify_url:r,is_mini_program:a,return_url:i}).then((function(s){var u={app_id:t.$c.app_id,timestamp:s.data.timestamp,v:t.$c.v,customer_id:t.customer_id,msg_digest:s.data.signCode,verified_way:n,page_modify:o,is_mini_program:a,cert_flag:d,notify_url:r,return_url:i};e.request({url:c.$c.fddApiUrl+"get_person_verify_url.api",header:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},data:u,method:"POST",success:function(e){var t=e.data;console.log("认证地址:",t),c.transactionNo=t.data.transactionNo;var n=c.$w_base.decode(t.data.url);c.fddSave(c.customer_id,t.data.transactionNo,n,(function(){c.$u.api.getUserInfo({}).then((function(e){var t=e.data.fddInfo;console.log("fddInfo:",t),t.url&&wx.navigateToMiniProgram({appId:"wx855361a721050c6b",path:"pages/result-loading/result-loading?verifyUrl="+encodeURIComponent(t.url),envVersion:"release",success:function(e){console.log(e)}})}))}))},fail:function(e){console.log(e)}})}))},isRz:function(t){var n=this,o=this;this.$u.api.signCode({verified_serialno:this.fddInfo.transactionId}).then((function(r){var i={app_id:n.$c.app_id,timestamp:r.data.timestamp,v:n.$c.v,msg_digest:r.data.signCode,verified_serialno:n.fddInfo.transactionId};e.request({url:o.$c.fddApiUrl+"find_personCertInfo.api",header:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},data:i,method:"POST",success:function(e){var n=e.data;console.log("查询实名认证测试输出:",e),t(n)},fail:function(e){console.log(e)}})}))},upcontract:function(){var t=this,n=this,o=this.fddInfo.customerId,r=this.orderInfo.contractId,i=this.orderInfo.signTitle,a=this.orderInfo.contractUrl,d=this.orderInfo.userAgreementId;console.log(r,d,"合同id  交易号"),e.setStorageSync("userAgreementId",r),console.log(this.orderInfo,"this.orderInfo"),this.$u.api.signCode({contract_id:r}).then((function(c){var s={app_id:t.$c.app_id,timestamp:c.data.timestamp,v:t.$c.v,msg_digest:c.data.signCode,contract_id:r,doc_title:i,doc_url:a,doc_type:".pdf"};e.request({url:n.$c.fddApiUrl+"uploaddocs.api",header:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},data:s,method:"POST",success:function(e){e.data;console.log(e,"合同上传...."),n.$f.jump("/pages1/web-view/web-view?contract_id="+r+"&customer_id="+o+"&doc_title="+i+"&doc_url="+a+"&transaction_id="+d)},fail:function(e){console.log(e)}})}))},contractQs:function(){return!1},submitBuy:function(){var t=this;console.log("判断是否实名认证：",this.fddInfo.customerId),this.fddInfo.customerId?this.isRz((function(n){console.log("审核通过情况：",n.data.person.status),2!=n.data.person.status?wx.navigateToMiniProgram({appId:"wx855361a721050c6b",path:"pages/result-loading/result-loading?verifyUrl="+encodeURIComponent(t.fddInfo.url),envVersion:"release",success:function(t){console.log(t),e.request({url:"http://huachuang.yxy5g.com/home/fddNotify",header:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST",success:function(e){console.log(e,"回调信息")},fail:function(e){console.log(e)}})}}):t.orderCreate()})):this.registerFdd()}}};t.default=o}).call(this,n(1)["default"])},440:function(e,t,n){"use strict";n.r(t);var o=n(441),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},441:function(e,t,n){}},[[434,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/pay/order.js.map